{{ if ne .chezmoi.os "windows" -}}
#!/usr/bin/env bash

cd "$(chezmoi execute-template '{{ .chezmoi.sourceDir }}')" || exit

{{ if eq .chezmoi.os "darwin" -}}
# HACK: Add `chezmoi` to NOPASS
root_cmd="sudo"
$root_cmd -v
ZDIR="/etc"
{{- else -}}
root_cmd="doas"
ZDIR=/etc/zsh
{{- end }}
[ -d $ZDIR ] || mkdir -p $ZDIR

{{ if (and (eq .chezmoi.os "linux") (eq .chezmoi.osRelease.id "arch")) -}}
# {{ include "__root__/etc/pacman.conf" | sha256sum }}
$root_cmd chezmoi execute-template --output=$ZDIR/pacman.conf \
  <__root__/etc/pacman.conf
{{- end }}

# {{ include "__root__/etc/zsh/zprofile" | sha256sum }}
$root_cmd chezmoi execute-template --output=$ZDIR/zprofile \
  <__root__/etc/zsh/zprofile

# {{ include "__root__/etc/zsh/zprofile" | sha256sum }}
$root_cmd chezmoi execute-template --output=$ZDIR/zshenv \
  <__root__/etc/zsh/zshenv

# vim:ft=sh.chezmoitmpl
{{- end }}
